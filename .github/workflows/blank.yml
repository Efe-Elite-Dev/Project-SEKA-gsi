name: A04s-All-In-One-Builder

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

      - name: Install Tools
        run: |
          sudo apt-get update
          sudo apt-get install -y android-sdk-libsparse-utils aria2

      - name: Download Files
        run: |
          # GSI ve Vendor dosyalarını çekiyoruz (Aria2 ile hızlı iniş)
          aria2c -s 16 -x 16 "https://drive.google.com/uc?export=download&id=1A8sLEoItqNuoX1LnWJUKokZRPtHter_k" -o miku.img
          aria2c -s 16 -x 16 "https://drive.google.com/uc?export=download&id=1S11bA-SEtg0ILETxerkTNblU_361vF7B" -o vendor.img

      - name: Elite Build (Package Only)
        run: |
          # Sparse kontrolü yap ve imajı hazırla
          simg2img miku.img A04s_Miku_AllInOne.img || cp miku.img A04s_Miku_AllInOne.img
          echo "Build tamamlandı aga!"

      - name: Create Miku Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: v1.0-Elite-Dev
          name: "A04s Miku ROM - Vocaloid World Edition"
          body: |
            ### A04s Project SEKA GSI
            - **Geliştirici:** Efe (@VocaloidWorld1)
            - **Yaş:** 13 (Yakında 14!)
            - **Cihaz:** Samsung Galaxy A04s
            - **Açıklama:** Bu ROM, Efe-Elite-Dev tarafından GH_TOKEN gücüyle derlenmiştir.
          files: A04s_Miku_AllInOne.img
          # Senin az önce eklediğin Secret burada devreye giriyor:
          token: ${{ secrets.GH_TOKEN }}
